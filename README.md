# Mass AWS Cognito User Pool Update

## Overview
This repository contains two BASH scripts and an example JSON designed to automate the process of updating multiple AWS Cognito user pools with the same configuration content. It is capable of handling a large number of user pools effectively.

**Important**: Before executing the script in a production environment, it is highly advisable to perform a backup of your existing configurations and conduct a trial run with a single user pool to verify the outcome. The provided scripts are intended for educational use, and caution should be exercised when applying changes in live environments. The author assumes no liability for their usage.

## Repository Contents
Included within this repository are several key components:

- `userpool-config.json`  
  An example JSON file that illustrates the expected format for new account creation and password setting with a PIN code response.

- `QueryUserPoolsPagination-1st.sh`  
  The initial script that iterates over all user pools within the default AWS region, or a specified one by code modification, and generates a list outputted to a file. Necessary as AWS API will error out if there is a significant number of User Pools in that region.

- `BackupUserPoolConfigs.sh`  
  Backs up each user pool configuration before performing modification, can also be used as a starter for your userpool-config.json

- `UpdateUserPools-2nd.sh`  
  The follow-up script that uses `userpool-config.json` as a template to update configurations across user pools, based on the list generated by the first script.

## Usage Instructions

1. **Backup**: Ensure you backup your current user pool configurations, how this is done is up to you but you could modify the first script and output everything to a log file.
2. **Test**: Execute the scripts on a single user pool to confirm the updates work as expected, the single pool can be placed in `listOfUserPools.txt`
3. **Deploy**: Run `QueryUserPoolsPagination-1st.sh` to retrieve the list of user pools.
4. **Update**: Execute `UpdateUserPools-2nd.sh` with the desired configuration JSON to update your user pools.

Note for testing purposes: Omit `--email-configuration` and `--sms-configuration` from script 2 L40-47 otherwise additional setup required for AWS SES

Feel free to utilize and modify these scripts as needed for your specific use case.